\RequirePackage{ifxetex}
\RequirePackage{ifluatex}
\ifluatex%
  \documentclass[a4paper]{ltjtarticle}
\else%
  \documentclass[a4paper]{utarticle}
\fi

\ifluatex%
  \usepackage{luatexja}
  \usepackage{luatexja-fontspec}
  % \usepackage[ipaex]{luatexja-preset}
  \usepackage[hiragino-pron]{luatexja-preset}
  \usepackage{luatexja-ruby}
\else\ifxetex%
\else%
  \usepackage{pxrubrica}
\fi\fi

%\documentclass[a4paper,twocolumn]{ltjtarticle}
% \documentclass[a4paper,landscape]{ltjsarticle}
\usepackage{multicol}
\usepackage{xparse}

\setlength{\columnseprule}{0.4pt}

\newcommand*{\HeadKanjiJaCommon}[1]{{\large 【#1】}}
\newcommand*{\HeadKanjiJaTrad}[2][]{{\large 【#2】}}
\newcommand*{\HeadKanjiJaSimp}[2][]{{\large 〖#2〗}}
\newcommand*{\HeadKanjiOther}[2][]{{\large 〔#2〕}}

\newcommand*{\HeadWord}[2][]{#1【#2】}
\newcommand*{\HeadWordVariant}[2][]{（#2）}

\newenvironment{Entry}{}{\par}
\newcommand{\Position}[2]{\leavevmode\llap{\rensuji[r]{\tiny #2}}}

\NewDocumentCommand{\KanjiYomiElem}{m o m}{
  #1\ #3
  \IfValueT{#2}
    {（#2）}
}

\ifluatex%
  \newcommand{\YomiUnit}[1]{#1\par}
  \newenvironment{Yomi}{}{\hspace*{1\fill} ・\hspace*{1\fill}\par}
\else%
  \newcommand*{\YomiUnit}{\item}
  \newenvironment{Yomi}{\begin{itemize}}{\end{itemize}}
\fi

\ifluatex%
  \newcommand{\Meaning}[1]{#1\par}
  \newenvironment{MeaningSg}{}{}
  \newenvironment{MeaningPl}{}{}
\else%
  \newcommand*{\Meaning}{\item}
  \newenvironment{MeaningSg}{}{}
  \newenvironment{MeaningPl}{\begin{itemize}}{\end{itemize}}
\fi